<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<!-- SEO + Compartir -->
<meta name="description" content="M√°scaras Therian artesanales hechas a mano en Costa Rica. Lobo, Zorro, Drag√≥n, Gato, Ciervo y B√∫ho. Env√≠os a todo el pa√≠s por Correos de CR."/>
<meta property="og:title" content="Therian Masks CR | M√°scaras Artesanales"/>
<meta property="og:description" content="M√°scaras Therian artesanales hechas a mano en Costa Rica. Env√≠os a todo el pa√≠s."/>
<meta property="og:image" content="logo.png"/>
<!-- Favicon -->
<link rel="icon" type="image/png" href="logo.png"/>
<link rel="apple-touch-icon" href="logo.png"/>
  
  <title>Therian Masks CR | M√°scaras  </title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --bg:           #faf9f7;
      --surface:      #ffffff;
      --border:       #e8e0f0;
      --purple:       #7c3aed;
      --purple2:      #5b21b6;
      --purple-light: #ede9fe;
      --purple-xlight:#f5f3ff;
      --gold:         #d97706;
      --text:         #1c1c1e;
      --muted:        #6b6b6b;
      --muted2:       #9ca3af;
      --green:        #059669;
      --red:          #dc2626;
      --radius:       12px;
      --shadow:       0 2px 12px rgba(0,0,0,0.08);
      --shadow-hover: 0 8px 32px rgba(124,58,237,0.18);
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:var(--bg); color:var(--text); font-family:'Nunito',sans-serif; }

    /* ‚îÄ‚îÄ TOP BAR ‚îÄ‚îÄ */
    .topbar {
      background: var(--purple2);
      color: #e9d5ff;
      font-size: 0.78rem;
      text-align: center;
      padding: 0.4rem 1rem;
      letter-spacing: 0.5px;
    }
    .topbar strong { color: #fff; }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    header {
      background: #fff;
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    .header-inner {
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.5rem 1.5rem;
      gap: 1rem;
    }

    /* Logo ‚Äî siempre a la izquierda */
    .logo {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      text-decoration: none;
      flex-shrink: 0;
    }
    .logo-img {
      width: 60px;
      height: 60px;
      object-fit: contain;
    }
    .logo-text { display: flex; flex-direction: column; gap: 0.1rem; }
    .logo-name {
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      color: var(--purple2);
      line-height: 1;
      white-space: nowrap;
    }
    .logo-sub {
      font-size: 0.65rem;
      color: var(--muted);
      letter-spacing: 1.5px;
      text-transform: uppercase;
      white-space: nowrap;
    }

    /* Nav central ‚Äî links */
    .header-nav {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      flex: 1;
      justify-content: center;
    }
    .nav-link {
      font-family: 'Nunito', sans-serif;
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--muted);
      text-decoration: none;
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .nav-link:hover { color: var(--purple); background: var(--purple-xlight); }
    .nav-link.active { color: var(--purple2); }

    /* Carrito ‚Äî siempre a la derecha */
    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-shrink: 0;
    }
    .cart-btn {
      background: var(--purple);
      border: none;
      border-radius: 50px;
      padding: 0.5rem 1.1rem;
      color: #fff;
      font-family: 'Nunito', sans-serif;
      font-weight: 700;
      font-size: 0.85rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.45rem;
      transition: all 0.25s;
      white-space: nowrap;
    }
    .cart-btn:hover { background: var(--purple2); transform: translateY(-1px); }
    .cart-count {
      background: var(--gold);
      color: #fff;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.68rem;
      font-weight: 800;
    }

    /* ‚îÄ‚îÄ MOBILE NAV BAR ‚Äî solo en m√≥vil, debajo del header ‚îÄ‚îÄ */
    .mobile-nav-bar {
      display: none; /* oculto en desktop */
    }

    /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
    .hero {
      background: linear-gradient(135deg, #2d1b69 0%, #4c1d95 50%, #6d28d9 100%);
      padding: 3.5rem 1.5rem;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }
    .hero-content { position: relative; max-width: 680px; margin: 0 auto; }
    .hero h1 {
      font-family: 'Cinzel', serif;
      font-size: clamp(2rem, 4.5vw, 3.2rem);
      color: #fff;
      margin-bottom: 0.75rem;
      line-height: 1.2;
    }
    .hero h1 span { color: #c4b5fd; }
    .hero p { color: #ddd6fe; font-size: 1.05rem; margin-bottom: 1.5rem; line-height: 1.6; }
    .hero-badges { display: flex; gap: 0.6rem; justify-content: center; flex-wrap: wrap; }
    .hero-badge {
      background: rgba(255,255,255,0.12);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 50px;
      padding: 0.35rem 1rem;
      color: #e9d5ff;
      font-size: 0.82rem;
    }

    /* ‚îÄ‚îÄ PAYMENT BAR ‚îÄ‚îÄ */
    .payment-bar {
      background: #fef9ec;
      border-bottom: 1px solid #fde68a;
      padding: 0.7rem 1.5rem;
    }
    .payment-bar-inner {
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
      font-size: 0.88rem;
      color: #92400e;
    }
    .payment-bar-inner strong { color: #78350f; }

    /* ‚îÄ‚îÄ SHOP LAYOUT ‚îÄ‚îÄ */
    .shop-layout {
      max-width: 1280px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }
    .shop-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
      flex-wrap: wrap;
      gap: 0.75rem;
    }
    .shop-title { font-family: 'Cinzel', serif; font-size: 1.5rem; color: var(--purple2); }
    .product-count { color: var(--muted); font-size: 0.9rem; margin-top: 0.1rem; }

    /* ‚îÄ‚îÄ FILTER BAR ‚îÄ‚îÄ */
    .filter-bar {
      display: flex;
      align-items: center;
      gap: 0.45rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
      padding: 0.9rem 1.1rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }
    .filter-label {
      font-size: 0.75rem;
      font-weight: 800;
      color: var(--muted2);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-right: 0.3rem;
      white-space: nowrap;
    }
    .cat-btn {
      background: var(--purple-xlight);
      border: 1.5px solid var(--border);
      border-radius: 50px;
      padding: 0.3rem 0.85rem;
      font-family: 'Nunito', sans-serif;
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--purple2);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .cat-btn:hover, .cat-btn.active {
      background: var(--purple);
      color: #fff;
      border-color: var(--purple);
    }

    /* ‚îÄ‚îÄ PRODUCT GRID ‚îÄ‚îÄ */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 1.5rem;
    }

    /* ‚îÄ‚îÄ PRODUCT CARD ‚îÄ‚îÄ */
    .product-card {
      background: var(--surface);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      overflow: hidden;
      transition: all 0.25s;
      cursor: pointer;
      position: relative;
    }
    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
      border-color: #c4b5fd;
    }
    .card-img-wrap {
      position: relative;
      aspect-ratio: 1;
      overflow: hidden;
      background: var(--purple-xlight);
    }
    .card-img-wrap img {
      width: 100%; height: 100%;
      object-fit: cover;
      transition: transform 0.4s;
    }
    .product-card:hover .card-img-wrap img { transform: scale(1.06); }
    .card-img-placeholder {
      width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
      font-size: 5rem;
      background: linear-gradient(135deg, #ede9fe, #ddd6fe);
    }
    .badge-dest {
      position: absolute; top: 10px; left: 10px;
      background: var(--purple); color: #fff;
      border-radius: 50px; padding: 0.2rem 0.65rem;
      font-size: 0.7rem; font-weight: 800;
    }
    .badge-agotado {
      position: absolute; inset: 0;
      background: rgba(0,0,0,0.55);
      display: flex; align-items: center; justify-content: center;
      color: #fff; font-weight: 800; font-size: 1.1rem; letter-spacing: 1px;
    }
    .wish-btn {
      position: absolute; top: 10px; right: 10px;
      background: rgba(255,255,255,0.92); border: none; border-radius: 50%;
      width: 32px; height: 32px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1rem;
      transition: all 0.2s;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .wish-btn:hover { transform: scale(1.15); }
    .wish-btn.active { color: #ef4444; }
    .card-body { padding: 0.9rem; }
    .card-cat { font-size: 0.72rem; color: var(--purple); font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem; }
    .card-name { font-weight: 700; font-size: 0.95rem; color: var(--text); margin-bottom: 0.3rem; line-height: 1.3; }
    .card-desc {
      font-size: 0.82rem; color: var(--muted); line-height: 1.4; margin-bottom: 0.7rem;
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
    }
    .card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      flex-wrap: nowrap;
    }
    .card-footer-price { flex-shrink: 0; }
    .card-price { font-size: 1.05rem; font-weight: 800; color: var(--text); white-space: nowrap; }
    .card-price-sub { font-size: 0.7rem; color: var(--muted); font-weight: 400; }
    .card-stock-low { font-size: 0.72rem; color: var(--red); font-weight: 700; margin-top: 0.2rem; }
    .add-to-cart {
      background: var(--purple); border: none; border-radius: 8px;
      padding: 0.55rem 0.7rem; color: #fff;
      font-family: 'Nunito', sans-serif; font-weight: 50; font-size: 0.68rem;
      cursor: pointer; transition: all 0.2s;
      white-space: nowrap; flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
      min-width: 0;
    }
    .add-to-cart:hover { background: var(--purple2); transform: translateY(-1px); }
    .add-to-cart:disabled { background: #d1d5db; cursor: not-allowed; transform: none; }

    /* ‚îÄ‚îÄ CART SIDEBAR ‚îÄ‚îÄ */
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
    .overlay.open { opacity: 1; pointer-events: all; }
    .cart-sidebar {
      position: fixed; right: 0; top: 0; bottom: 0;
      width: min(430px, 100vw); background: #fff;
      border-left: 1px solid var(--border); z-index: 300;
      display: flex; flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.35s cubic-bezier(.4,0,.2,1);
      box-shadow: -8px 0 32px rgba(0,0,0,0.12);
    }
    .cart-sidebar.open { transform: translateX(0); }
    .cart-head {
      padding: 1.2rem 1.5rem; border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      background: var(--purple-xlight);
    }
    .cart-head h2 { font-family: 'Cinzel', serif; font-size: 1.1rem; color: var(--purple2); }
    .close-x { background: none; border: none; font-size: 1.4rem; cursor: pointer; color: var(--muted); transition: color 0.2s; }
    .close-x:hover { color: var(--text); }
    .cart-body { flex: 1; overflow-y: auto; padding: 1rem; }
    .cart-empty { text-align: center; padding: 3rem 1rem; color: var(--muted); }
    .cart-empty .ei { font-size: 3rem; margin-bottom: 0.75rem; }
    .cart-item {
      display: flex; gap: 0.9rem; padding: 0.9rem;
      border: 1px solid var(--border); border-radius: var(--radius);
      margin-bottom: 0.75rem; background: #fff;
    }
    .ci-img { width: 62px; height: 62px; border-radius: 8px; overflow: hidden; background: var(--purple-xlight); flex-shrink: 0; }
    .ci-img img { width: 100%; height: 100%; object-fit: cover; }
    .ci-img-ph { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; }
    .ci-info { flex: 1; }
    .ci-name { font-weight: 700; font-size: 0.88rem; margin-bottom: 0.2rem; }
    .ci-price { color: var(--purple); font-size: 0.82rem; font-weight: 600; }
    .qty-row { display: flex; align-items: center; gap: 0.5rem; margin-top: 0.4rem; }
    .qbtn {
      width: 26px; height: 26px; border: 1px solid var(--border); border-radius: 6px;
      background: #fff; cursor: pointer; font-size: 1rem; transition: all 0.2s;
      display: flex; align-items: center; justify-content: center;
    }
    .qbtn:hover { background: var(--purple); color: #fff; border-color: var(--purple); }
    .qnum { font-weight: 700; min-width: 22px; text-align: center; font-size: 0.9rem; }
    .ci-del { background: none; border: none; cursor: pointer; color: var(--muted2); font-size: 1.1rem; transition: color 0.2s; align-self: flex-start; }
    .ci-del:hover { color: var(--red); }
    .cart-foot { padding: 1.2rem 1.5rem; border-top: 1px solid var(--border); }
    .total-row { display: flex; justify-content: space-between; font-size: 1.05rem; font-weight: 700; margin-bottom: 0.3rem; }
    .total-amount { color: var(--purple2); font-size: 1.3rem; }
    .envio-note { font-size: 0.78rem; color: var(--muted); margin-bottom: 1rem; }
    .pay-notice {
      background: #fef9ec; border: 1px solid #fde68a; border-radius: 8px;
      padding: 0.7rem 0.9rem; font-size: 0.78rem; color: #92400e; margin-bottom: 1rem;
    }
    .pay-notice strong { color: #78350f; display: block; margin-bottom: 0.15rem; }
    .form-grp { margin-bottom: 0.7rem; }
    .form-grp label { display: block; font-size: 0.78rem; font-weight: 700; color: var(--muted); margin-bottom: 0.3rem; }
    .form-grp input {
      width: 100%; border: 1px solid var(--border); border-radius: 8px;
      padding: 0.6rem 0.8rem; font-family: 'Nunito', sans-serif; font-size: 0.9rem;
      color: var(--text); transition: border-color 0.2s; background: #fff;
    }
    .form-grp input:focus { outline: none; border-color: var(--purple); }
    .form-grp input::placeholder { color: var(--muted2); }
    .wa-btn {
      width: 100%; background: linear-gradient(135deg, #25d366, #128c7e);
      border: none; border-radius: 10px; padding: 0.85rem; color: #fff;
      font-family: 'Nunito', sans-serif; font-size: 1rem; font-weight: 800;
      cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.6rem;
      transition: all 0.25s; margin-top: 0.5rem;
    }
    .wa-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(37,211,102,0.35); }
    .wa-btn:disabled { background: #d1d5db; cursor: not-allowed; transform: none; box-shadow: none; }

    /* ‚îÄ‚îÄ POP-OUT NOTIFICACI√ìN ‚îÄ‚îÄ */
    .popout {
      position: fixed;
      bottom: 1.5rem;
      left: 50%;
      transform: translateX(-50%) translateY(120px);
      z-index: 9999;
      transition: transform 0.4s cubic-bezier(.34,1.56,.64,1), opacity 0.3s;
      opacity: 0;
      pointer-events: none;
      width: min(340px, calc(100vw - 2rem));
    }
    .popout.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
      pointer-events: all;
    }
    .popout-inner {
      background: #fff;
      border: 1.5px solid var(--border);
      border-radius: 16px;
      padding: 0.9rem 1.1rem;
      display: flex;
      align-items: center;
      gap: 0.85rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15), 0 2px 8px rgba(124,58,237,0.12);
    }
    .popout-icon {
      width: 40px; height: 40px;
      background: linear-gradient(135deg, #7c3aed, #5b21b6);
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.2rem;
      flex-shrink: 0;
    }
    .popout-text { flex: 1; min-width: 0; }
    .popout-title {
      font-weight: 800;
      font-size: 0.82rem;
      color: var(--purple2);
      margin-bottom: 0.1rem;
    }
    .popout-name {
      font-size: 0.78rem;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .popout-check {
      width: 28px; height: 28px;
      background: #d1fae5;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    /* toast simple para mensajes de error/warning */
    .toast {
      position: fixed; bottom: 1.5rem; left: 50%;
      transform: translateX(-50%) translateY(80px);
      background: var(--purple2); color: #fff; border-radius: 50px;
      padding: 0.65rem 1.4rem; font-weight: 700; font-size: 0.9rem;
      z-index: 9998; transition: transform 0.35s cubic-bezier(.4,0,.2,1);
      white-space: nowrap; box-shadow: 0 4px 16px rgba(0,0,0,0.2);
      opacity: 0; pointer-events: none;
    }
    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    /* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.72);
      z-index: 400; opacity: 0; pointer-events: none;
      transition: opacity 0.3s;
      display: flex; align-items: center; justify-content: center; padding: 1rem;
    }
    .modal-overlay.open { opacity: 1; pointer-events: all; }
    .modal {
      background: #fff; border-radius: 18px; overflow: hidden;
      max-width: 820px; width: 100%; max-height: 90vh;
      display: flex; flex-direction: row; position: relative;
      transform: scale(0.92) translateY(24px);
      transition: transform 0.32s cubic-bezier(.4,0,.2,1);
      box-shadow: 0 28px 70px rgba(0,0,0,0.28);
    }
    .modal-overlay.open .modal { transform: scale(1) translateY(0); }
    .modal-img {
      width: 48%; flex-shrink: 0; overflow: hidden;
      background: var(--purple-xlight);
      display: flex; align-items: center; justify-content: center;
    }
    .modal-img img { width: 100%; height: 100%; object-fit: cover; }
    .modal-img-ph { font-size: 8rem; }
    .modal-info {
      flex: 1; padding: 2rem 1.8rem; overflow-y: auto;
      display: flex; flex-direction: column; gap: 0.9rem;
    }
    .modal-cat { font-size: 0.72rem; font-weight: 800; color: var(--purple); text-transform: uppercase; letter-spacing: 1.5px; }
    .modal-name { font-family: 'Cinzel', serif; font-size: 1.45rem; color: var(--text); line-height: 1.3; }
    .modal-price-wrap { display: flex; align-items: baseline; gap: 0.4rem; }
    .modal-price { font-size: 1.9rem; font-weight: 800; color: var(--purple2); }
    .modal-price-label { font-size: 0.82rem; color: var(--muted); }
    .modal-divider { border: none; border-top: 1px solid var(--border); }
    .modal-desc { color: var(--muted); line-height: 1.75; font-size: 0.93rem; }
    .modal-stock-info { font-size: 0.82rem; font-weight: 700; }
    .modal-stock-info.ok  { color: var(--green); }
    .modal-stock-info.low { color: var(--gold); }
    .modal-stock-info.out { color: var(--red); }
    .modal-add {
      background: linear-gradient(135deg, var(--purple), var(--purple2));
      border: none; border-radius: 10px; padding: 0.9rem 1.5rem; color: #fff;
      font-family: 'Nunito', sans-serif; font-size: 1rem; font-weight: 800;
      cursor: pointer; transition: all 0.25s; margin-top: auto;
      display: flex; align-items: center; justify-content: center; gap: 0.5rem;
    }
    .modal-add:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(124,58,237,0.35); }
    .modal-add:disabled { background: #d1d5db; cursor: not-allowed; transform: none; box-shadow: none; }
    .modal-close {
      position: absolute; top: 14px; right: 14px;
      background: rgba(0,0,0,0.07); border: none; border-radius: 50%;
      width: 36px; height: 36px; font-size: 1.1rem; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.2s; z-index: 10; color: var(--text);
    }
    .modal-close:hover { background: rgba(0,0,0,0.15); }

    /* ‚îÄ‚îÄ EMPTY ‚îÄ‚îÄ */
    .empty-store { text-align: center; padding: 4rem 1rem; color: var(--muted); }
    .empty-store .ei { font-size: 4rem; margin-bottom: 1rem; }

    /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
    footer {
      background: #fff; border-top: 1px solid var(--border);
      text-align: center; padding: 2rem 1.5rem; color: var(--muted); font-size: 0.85rem;
    }
    footer .ft-logo { font-family: 'Cinzel', serif; color: var(--purple2); font-size: 1rem; margin-bottom: 0.3rem; }

    /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
    @media (max-width: 768px) {
      header {
        position: fixed;
        top: 0; left: 0; right: 0; width: 100%;
      }
      /* Compensar header fijo (‚âà62px) + barra de nav m√≥vil (‚âà38px) */
      body { padding-top: 100px; }

      .header-inner { padding: 0.4rem 0.9rem; gap: 0.5rem; }
      .header-nav { display: none; }
      .logo { min-width: 0; }
      .logo-img { width: 46px; height: 46px; }
      .logo-name { font-size: 0.82rem; }
      .logo-sub { display: none; }

      /* Carrito: √≠cono visible y bien proporcionado en m√≥vil */
      .cart-btn .cart-label { display: none; }
      .cart-btn {
        padding: 0.6rem 0.75rem;
        border-radius: 14px;
        width: auto;
        height: auto;
        min-width: 44px;
        min-height: 44px;
        justify-content: center;
        font-size: 1.1rem;
      }

      /* Barra de nav m√≥vil ‚Äî aparece pegada debajo del header fijo */
      .mobile-nav-bar {
        display: flex;
        position: fixed;
        top: 62px; /* justo debajo del header */
        left: 0; right: 0;
        z-index: 99;
        background: var(--purple-xlight);
        border-bottom: 1px solid var(--border);
        padding: 0 1rem;
        gap: 0;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }
      .mobile-nav-bar::-webkit-scrollbar { display: none; }

      .mobile-nav-link {
        display: flex;
        align-items: center;
        gap: 0.3rem;
        padding: 0.55rem 1rem;
        font-family: 'Nunito', sans-serif;
        font-size: 0.82rem;
        font-weight: 700;
        color: var(--muted);
        text-decoration: none;
        white-space: nowrap;
        border-bottom: 2px solid transparent;
        transition: all 0.2s;
        flex-shrink: 0;
      }
      .mobile-nav-link:hover,
      .mobile-nav-link.active {
        color: var(--purple2);
        border-bottom-color: var(--purple);
      }
    }
    @media (max-width: 600px) {
      .hero { padding: 2.5rem 1rem; }
      .products-grid { grid-template-columns: repeat(auto-fill, minmax(160px,1fr)); gap: 1rem; }
      .card-body { padding: 0.7rem; }
      .card-name { font-size: 0.85rem; }
      .modal { flex-direction: column; max-height: 95vh; }
      .modal-img { width: 100%; height: 220px; flex-shrink: 0; }
      .modal-info { padding: 1.2rem; }
      .modal-name { font-size: 1.15rem; }
      .filter-bar { padding: 0.7rem; }
    }
  </style>
</head>
<body>

<div class="topbar">
  üá®üá∑ Env√≠os a todo Costa Rica por <strong>Correos de Costa Rica</strong> &nbsp;¬∑&nbsp; Pago por <strong>SINPE M√≥vil o Dep√≥sito</strong>
</div>

<header>
  <div class="header-inner">
    <!-- LOGO ‚Äî izquierda -->
    <a class="logo" href="index.html">
      <img class="logo-img" src="logo.png" alt="Therian Masks CR">
      <div class="logo-text">
        <div class="logo-name">Therian Masks CR</div>
        <div class="logo-sub">M√°scaras ¬∑ Costa Rica</div>
      </div>
    </a>

    <!-- NAV CENTRAL -->
    <nav class="header-nav">
      <a class="nav-link active" href="index.html">üé≠ Tienda</a>
      <a class="nav-link" href="historia.html">üåø ¬øQu√© es un Therian?</a>
    </nav>

    <!-- CARRITO ‚Äî derecha -->
    <div class="header-actions">
      <button class="cart-btn" onclick="toggleCart()">
        üõí <span class="cart-label">Carrito</span>
        <div class="cart-count" id="cartCount">0</div>
      </button>
    </div>
  </div>
</header>

<!-- BARRA DE NAV M√ìVIL ‚Äî solo visible en m√≥vil, debajo del header fijo -->
<div class="mobile-nav-bar">
  <a class="mobile-nav-link active" href="index.html">üé≠ Tienda</a>
  <a class="mobile-nav-link" href="historia.html">üåø ¬øQu√© es un Therian?</a>
</div>

<div class="hero">
  <div class="hero-content">
    <h1>M√°scaras <span>Therian</span><br/> </h1>
    <p>M√°scaras de alta calidad para conectar con tu esp√≠ritu animal. Env√≠os a todo Costa Rica.</p>
    <div class="hero-badges">
      <div class="hero-badge">üé≠ M√°scaras Therian</div>
      <div class="hero-badge">üá®üá∑ Entrega en Costa Rica</div>
      <div class="hero-badge">üì¶ Env√≠o por Correos de CR</div>
    </div>
  </div>
</div>

<div class="payment-bar">
  <div class="payment-bar-inner">
    <span>‚è±Ô∏è ¬øC√≥mo funciona?</span>
    <span>Envi√°s tu carrito por WhatsApp ‚Üí Ten√©s <strong>2 horas para confirmar tu pago</strong> (SINPE M√≥vil al <strong>6007-2890</strong> a nombre de <strong>Paulo J</strong> / dep√≥sito bancario) ‚Üí Coordinamos el env√≠o por Correos de Costa Rica.</span>
  </div>
</div>

<!-- TIENDA -->
<div class="shop-layout">
  <div class="shop-header">
    <div>
      <div class="shop-title">üé≠ Nuestras M√°scaras</div>
      <div class="product-count" id="productCount"></div>
    </div>
  </div>

  <!-- FILTROS ANTES DE LA GRILLA -->
  <div class="filter-bar" id="catFilter">
    <span class="filter-label">Filtrar por:</span>
    <button class="cat-btn active" onclick="filtrar('todos',this)">Todos</button>
  </div>

  <div class="products-grid" id="productsGrid">
    <div class="empty-store"><div class="ei">‚è≥</div><p>Cargando productos...</p></div>
  </div>
</div>

<footer>
  <div class="ft-logo">Therian Masks CR</div>
  <p>M√°scaras Therian para Costa Rica üåø</p>
  <p style="margin-top:0.4rem">Pagos: SINPE M√≥vil <strong>6007-2890</strong> ¬∑ Paulo J ¬∑ Env√≠os: Correos de Costa Rica</p>
</footer>

<!-- OVERLAY + CARRITO SIDEBAR -->
<div class="overlay" id="overlay" onclick="toggleCart()"></div>
<div class="cart-sidebar" id="cartSidebar">
  <div class="cart-head">
    <h2>üõí Tu Pedido</h2>
    <button class="close-x" onclick="toggleCart()">‚úï</button>
  </div>
  <div class="cart-body" id="cartBody"></div>
  <div class="cart-foot">
    <div class="total-row">
      <span>Subtotal</span>
      <span class="total-amount" id="cartTotal">‚Ç°0</span>
    </div>
    <div class="envio-note">+ Costo de env√≠o seg√∫n tu ubicaci√≥n (Correos de CR)</div>
    <div class="pay-notice">
      <strong>‚è±Ô∏è Ten√©s 2 horas para pagar</strong>
      SINPE M√≥vil: <strong>6007-2890</strong> ¬∑ Paulo J<br/>
      O dep√≥sito bancario (te indicamos los datos por WhatsApp)
    </div>
    <div class="form-grp">
      <label>Tu nombre completo *</label>
      <input type="text" id="clientName" placeholder="Ej: Mar√≠a Gonz√°lez"/>
    </div>
    <div class="form-grp">
      <label>Provincia / Cant√≥n *</label>
      <input type="text" id="clientCity" placeholder="Ej: San Jos√©, Desamparados"/>
    </div>
    <button class="wa-btn" onclick="enviarWA()">
      <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
      Enviar Pedido por WhatsApp
    </button>
  </div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModalOutside(event)">
  <div class="modal" id="productModal">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <div class="modal-img" id="modalImg"></div>
    <div class="modal-info">
      <div class="modal-cat" id="modalCat"></div>
      <div class="modal-name" id="modalName"></div>
      <div class="modal-price-wrap">
        <div class="modal-price" id="modalPrice"></div>
        <div class="modal-price-label">colones</div>
      </div>
      <hr class="modal-divider"/>
      <div class="modal-desc" id="modalDesc"></div>
      <div class="modal-stock-info" id="modalStock"></div>
      <button class="modal-add" id="modalAddBtn">üõí Agregar al carrito</button>
    </div>
  </div>
</div>

<!-- POP-OUT NOTIFICACI√ìN PRODUCTO AGREGADO -->
<div class="popout" id="popout">
  <div class="popout-inner">
    <div class="popout-icon">üõí</div>
    <div class="popout-text">
      <div class="popout-title">¬°Agregado al carrito!</div>
      <div class="popout-name" id="popoutName"></div>
    </div>
    <div class="popout-check">‚úÖ</div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
  const WA_NUMBER = "50660072890";
  let productos = [];
  let cart = JSON.parse(localStorage.getItem('therian_cart') || '[]');
  let wishlist = new Set();
  let filtroActivo = "todos";

  async function cargarProductos() {
    try {
      const res = await fetch('productos.json');
      if (!res.ok) throw new Error();
      productos = await res.json();
    } catch {
      productos = [
        { nombre:"M√°scara de Lobo Lunar",    descripcion:"Dise√±o lunar con detalles plateados. Orejas articuladas y acabado satinado.", precio:25000, stock:10, foto:"", categoria:"Lobo",   destacado:true  },
        { nombre:"M√°scara de Zorro Oto√±al",  descripcion:"Tonos c√°lidos de naranja y caf√©. Acabado mate premium.",                      precio:22000, stock:8,  foto:"", categoria:"Zorro",  destacado:false },
        { nombre:"M√°scara de Drag√≥n M√≠stico",descripcion:"Escamas pintadas a mano, cuernos elaborados. Pieza de colecci√≥n.",             precio:38000, stock:3,  foto:"", categoria:"Drag√≥n", destacado:true  },
        { nombre:"M√°scara de Gato Nocturno", descripcion:"Elegante y minimalista. Orejas de tela, acabado negro satinado.",              precio:18000, stock:0,  foto:"", categoria:"Gato",   destacado:false },
        { nombre:"M√°scara de Ciervo Sagrado",descripcion:"Astas naturales, pintura blanca y dorada.",                                    precio:32000, stock:5,  foto:"", categoria:"Ciervo", destacado:true  },
        { nombre:"M√°scara de B√∫ho Sabio",    descripcion:"Plumas decorativas y ojos expresivos. Gran detalle en pintado manual.",        precio:28000, stock:7,  foto:"", categoria:"B√∫ho",   destacado:false },
      ];
    }
    buildCatFilter();
    renderProductos();
  }

  const EMOJIS = {"Lobo":"üê∫","Zorro":"ü¶ä","Drag√≥n":"üêâ","Gato":"üê±","Ciervo":"ü¶å","B√∫ho":"ü¶â"};

  function buildCatFilter() {
    const cats = [...new Set(productos.map(p => p.categoria))].filter(Boolean);
    const div = document.getElementById('catFilter');
    cats.forEach(cat => {
      const btn = document.createElement('button');
      btn.className = 'cat-btn';
      btn.textContent = (EMOJIS[cat] || 'üé≠') + ' ' + cat;
      btn.onclick = () => filtrar(cat, btn);
      div.appendChild(btn);
    });
  }

  function filtrar(cat, btn) {
    if (filtroActivo === cat && cat !== 'todos') {
      filtroActivo = 'todos';
      document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
      document.querySelector('.cat-btn').classList.add('active');
    } else {
      filtroActivo = cat;
      document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
    renderProductos();
  }

  function renderProductos() {
    const grid = document.getElementById('productsGrid');
    const lista = filtroActivo === 'todos' ? productos : productos.filter(p => p.categoria === filtroActivo);
    document.getElementById('productCount').textContent = lista.length + ' producto' + (lista.length !== 1 ? 's' : '');
    if (!lista.length) {
      grid.innerHTML = `<div class="empty-store"><div class="ei">üé≠</div><p>No hay productos en esta categor√≠a.</p></div>`;
      return;
    }
    grid.innerHTML = lista.map(p => {
      const realIdx = productos.indexOf(p);
      const agotado = p.stock === 0;
      const emoji = EMOJIS[p.categoria] || 'üé≠';
      const imgHtml = p.foto ? `<img src="${p.foto}" alt="${p.nombre}" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">` : '';
      const phStyle = p.foto ? 'style="display:none"' : '';
      const stockLow = p.stock > 0 && p.stock <= 3;
      return `
        <div class="product-card" onclick="openModal(${realIdx})">
          <div class="card-img-wrap">
            ${imgHtml}
            <div class="card-img-placeholder" ${phStyle}>${emoji}</div>
            ${p.destacado ? '<div class="badge-dest">‚≠ê Destacado</div>' : ''}
            ${agotado ? '<div class="badge-agotado">AGOTADO</div>' : ''}
            <button class="wish-btn ${wishlist.has(realIdx)?'active':''}" onclick="event.stopPropagation();toggleWish(${realIdx},this)" title="Favorito">
              ${wishlist.has(realIdx) ? '‚ù§Ô∏è' : 'ü§ç'}
            </button>
          </div>
          <div class="card-body">
            <div class="card-cat">${p.categoria || 'M√°scaras'}</div>
            <div class="card-name">${p.nombre}</div>
            <div class="card-desc">${p.descripcion}</div>
            ${stockLow ? `<div class="card-stock-low">‚ö†Ô∏è ¬°Solo ${p.stock} disponible${p.stock>1?'s':''}!</div>` : ''}
            <div class="card-footer">
              <div class="card-footer-price">
                <div class="card-price">‚Ç°${p.precio.toLocaleString('es-CR')}</div>
                <div class="card-price-sub">colones</div>
              </div>
              <button class="add-to-cart" onclick="event.stopPropagation();addToCart(${realIdx})" ${agotado?'disabled':''}>
                ${agotado ? 'Agotado' : '+ Agregar'}
              </button>
            </div>
          </div>
        </div>`;
    }).join('');
  }

  function toggleWish(idx, btn) {
    if (wishlist.has(idx)) { wishlist.delete(idx); btn.textContent='ü§ç'; btn.classList.remove('active'); }
    else { wishlist.add(idx); btn.textContent='‚ù§Ô∏è'; btn.classList.add('active'); showToast('‚ù§Ô∏è Agregado a favoritos'); }
  }

  function addToCart(idx) {
    const p = productos[idx];
    const ex = cart.find(i => i.idx === idx);
    if (ex) { if (ex.qty < p.stock) { ex.qty++; } else { showToast('‚ö†Ô∏è No hay m√°s stock'); return; } }
    else { cart.push({ idx, nombre:p.nombre, precio:p.precio, foto:p.foto, categoria:p.categoria, qty:1 }); }
    updateCartUI();
    showPopout(p.nombre);
    localStorage.setItem('therian_cart', JSON.stringify(cart)); // ‚Üê agreg√° esta l√≠nea
  const total = cart.reduce((s,i) => s + i.precio * i.qty, 0);
  }

  function removeFromCart(idx) { cart = cart.filter(i => i.idx !== idx); updateCartUI(); }

  function changeQty(idx, d) {
    const item = cart.find(i => i.idx === idx);
    if (!item) return;
    item.qty += d;
    if (item.qty <= 0) removeFromCart(idx);
    else updateCartUI();
  }

  function updateCartUI() {
    const total = cart.reduce((s,i) => s + i.precio * i.qty, 0);
    const count = cart.reduce((s,i) => s + i.qty, 0);
    document.getElementById('cartCount').textContent = count;
    document.getElementById('cartTotal').textContent = '‚Ç°' + total.toLocaleString('es-CR');
    const body = document.getElementById('cartBody');
    if (!cart.length) {
      body.innerHTML = `<div class="cart-empty"><div class="ei">üõí</div><p>Tu carrito est√° vac√≠o</p><p style="font-size:.82rem;margin-top:.4rem;color:var(--muted2)">Agreg√° algunas m√°scaras üé≠</p></div>`;
      return;
    }
    const emoji = cat => EMOJIS[cat] || 'üé≠';
    body.innerHTML = cart.map(item => `
      <div class="cart-item">
        <div class="ci-img">
          ${item.foto ? `<img src="${item.foto}" alt="${item.nombre}" onerror="this.style.display='none'">` : `<div class="ci-img-ph">${emoji(item.categoria)}</div>`}
        </div>
        <div class="ci-info">
          <div class="ci-name">${item.nombre}</div>
          <div class="ci-price">‚Ç°${item.precio.toLocaleString('es-CR')} c/u</div>
          <div class="qty-row">
            <button class="qbtn" onclick="changeQty(${item.idx},-1)">‚àí</button>
            <span class="qnum">${item.qty}</span>
            <button class="qbtn" onclick="changeQty(${item.idx},1)">+</button>
          </div>
        </div>
        <button class="ci-del" onclick="removeFromCart(${item.idx})">üóëÔ∏è</button>
      </div>`).join('');
  }

  function toggleCart() {
    document.getElementById('cartSidebar').classList.toggle('open');
    document.getElementById('overlay').classList.toggle('open');
  }

  function enviarWA() {
    if (!cart.length) { showToast('‚ùå Tu carrito est√° vac√≠o'); return; }
    const name = document.getElementById('clientName').value.trim();
    const city = document.getElementById('clientCity').value.trim();
    if (!name) { showToast('‚ö†Ô∏è Por favor ingres√° tu nombre'); return; }
    if (!city) { showToast('‚ö†Ô∏è Por favor ingres√° tu provincia/cant√≥n'); return; }
    const total = cart.reduce((s,i) => s + i.precio * i.qty, 0);
    let msg = `üé≠ *PEDIDO ‚Äî Therian Masks CR*\n\n`;
    msg += `üë§ *Cliente:* ${name}\nüìç *Ubicaci√≥n:* ${city}\nüì¶ *Env√≠o:* Correos de Costa Rica\n\nüõí *Detalle:*\n`;
    cart.forEach(i => { msg += `  ‚Ä¢ ${i.nombre} √ó${i.qty} ‚Üí ‚Ç°${(i.precio*i.qty).toLocaleString('es-CR')}\n`; });
    msg += `\nüí∞ *TOTAL: ‚Ç°${total.toLocaleString('es-CR')}*\n\n`;
    msg += `‚è±Ô∏è _Quedo en espera de los datos de pago. Confirmo en m√°ximo 2 horas._\n`;
    msg += `‚úÖ _Pago: SINPE M√≥vil 6007-2890 ¬∑ Paulo J_`;
    window.open(`https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank');
  }

  let popoutTimer = null;
  function showPopout(nombre) {
    const el = document.getElementById('popout');
    document.getElementById('popoutName').textContent = nombre;
    el.classList.add('show');
    clearTimeout(popoutTimer);
    popoutTimer = setTimeout(() => el.classList.remove('show'), 2800);
  }

  function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg; t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 2800);
  }

  let modalIdx = null;
  function openModal(idx) {
    const p = productos[idx];
    modalIdx = idx;
    const emoji = EMOJIS[p.categoria] || 'üé≠';
    const imgDiv = document.getElementById('modalImg');
    imgDiv.innerHTML = p.foto
      ? `<img src="${p.foto}" alt="${p.nombre}" onerror="this.outerHTML='<div class=modal-img-ph>${emoji}</div>'">`
      : `<div class="modal-img-ph">${emoji}</div>`;
    document.getElementById('modalCat').textContent   = p.categoria || 'M√°scara';
    document.getElementById('modalName').textContent  = p.nombre;
    document.getElementById('modalPrice').textContent = '‚Ç°' + p.precio.toLocaleString('es-CR');
    document.getElementById('modalDesc').textContent  = p.descripcion;
    const stockEl = document.getElementById('modalStock');
    const btn = document.getElementById('modalAddBtn');
    if (p.stock === 0) {
      stockEl.textContent = '‚ùå Agotado'; stockEl.className = 'modal-stock-info out';
      btn.disabled = true; btn.textContent = 'Agotado';
    } else if (p.stock <= 3) {
      stockEl.textContent = `‚ö†Ô∏è ¬°Solo ${p.stock} disponible${p.stock>1?'s':''}!`; stockEl.className = 'modal-stock-info low';
      btn.disabled = false; btn.textContent = 'üõí Agregar al carrito';
    } else {
      stockEl.textContent = `‚úÖ En stock (${p.stock} disponibles)`; stockEl.className = 'modal-stock-info ok';
      btn.disabled = false; btn.textContent = 'üõí Agregar al carrito';
    }
    btn.onclick = () => addFromModal();
    document.getElementById('modalOverlay').classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    document.getElementById('modalOverlay').classList.remove('open');
    document.body.style.overflow = '';
    modalIdx = null;
  }
  function closeModalOutside(e) { if (e.target === document.getElementById('modalOverlay')) closeModal(); }
  document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });
  function addFromModal() {
    if (modalIdx === null) return;
    addToCart(modalIdx);
    closeModal();
  }

  cargarProductos();
</script>
</body>
</html>
